//- ì´ íŒŒì¼ì„ í˜¸ì¶œí•˜ëŠ” ../_mixins.pug íŒŒì¼ì€ ../base.pug íŒŒì¼ì—ì„œ include ë˜ì–´ìˆì–´,
//-  indexì™€ ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° í˜ì´ì§€ë¥¼ ì œì™¸í•œ ëª¨ë“  í˜ì´ì§€ì—ì„œ ë”°ë¡œ include ì—†ì´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

//- Bulletn Board Post View Template [ ê²Œì‹œíŒ ê¸€ ìƒì„¸ë³´ê¸° í…œí”Œë¦¿ ]
//- ğŸ’¥ ê²Œì‹œíŒ ê¸€ ìƒì„¸ë³´ê¸° í…œí”Œë¦¿ì€ 'url ì— ì¡´ì¬í•˜ëŠ” id ê°’ìœ¼ë¡œ ë°±ì—”ë“œì—ì„œ ì •ë³´ë¥¼ ì°¾ì•„ì„œ í…œí”Œë¦¿ ì—”ì§„ì— ì „ë‹¬í•´ì£¼ëŠ” ë°©ë²•' ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
//- ì¦‰, ì„œë²„ ì‚¬ì´ë“œì—ì„œ í•´ë‹¹í•˜ëŠ” í˜ì´ì§€ì˜ ë°ì´í„° ë Œë”ë§ì´ ëª¨ë‘ ëë‚œ í›„ ì œê³µë©ë‹ˆë‹¤. 

//- title, createdAt, writer, hit,
//- file,
//- ìƒì„¸ë³´ê¸°ì „ ê²Œì‹œê¸€ ì£¼ì†Œ (ex - community/board)
mixin postView(post, referrer, accessUser, comments)
  article.post-view
    // ì‹œê°„ ê°€ê³µ í•¨ìˆ˜
    mixin processDateTime(createdAt, updatedAt, kind)
      - const now = new Date();
      - const addTime = (hours, oldDate, newDate = now) => {newDate.setTime(oldDate.getTime() + (hours * 60 * 60 * 1000)); return newDate;}
      - const yymmdd = (dateObj = addTime(9, now)) => dateObj.toISOString().match(/^\d{4}-\d{2}-\d{2}(?=T)/)[0];
      - const hhmm = (dateObj = addTime(9, now)) => dateObj.toISOString().match(/(?<=T)\d{2}:\d{2}(?=:\d{2})/)[0];
      
      - const GMT = createdAt;
      - const KST = addTime(9, GMT);
      - const createdDate = yymmdd(KST);
      - const createdTime = hhmm(KST);
      - const isUpdated = createdAt.getTime() !== updatedAt.getTime() ? true : false;

      case kind
        when 'post'
          div.post-view__header__prop.post-view__header__createdAt
            span= createdDate
            span= createdTime
            if isUpdated
              span ( ìˆ˜ì •ë¨ )
        when 'comment'
          span= createdDate
          span= createdTime
          if isUpdated
            span ( ìˆ˜ì •ë¨ )
    |
    |
    // ê²Œì‹œê¸€ í—¤ë”
    section.post-view__header
      //- í—¤ë”ì— í‘œì‹œë  ê²Œì‹œê¸€ì˜ ì†ì„± = ['title', 'createdAt', 'writer', 'hit'];
      div.post-view__header__title= post.title
      +processDateTime(post.createdAt, post.updatedAt, 'post')
      div.post-view__header__prop.post-view__header__writer= post.UserId
      div.post-view__header__prop.post-view__header__hit= post.Inquiries[0].count
    |
    |
    // ê²Œì‹œê¸€ ë‚´ìš©
    section.post-view__content
      section.post-view__content__images
        each image in post.Images
          - const src = `https://www.ddccomputer.club/uploads/${image.src}`
          img(src= src).post-view__content__image
      //- ê°œë°œ í™˜ê²½ ì´ë¯¸ì§€ ë¡œë“œ ë¶ˆê°€ ì•ˆë‚´ë¥¼ ìœ„í•œ ì´ë¯¸ì§€ ìœ ë¬´ ê²€ì¦
      - const isImage = Boolean(post.Images[0]);
      output(data-is-image-for-localhost= `${isImage}`)
      |
      |
      section.post-view__content__txt-wrap
        pre.post-view__content__txt= post.content
    |
    |
    // ê²Œì‹œê¸€ í‘¸í„° (ë²„íŠ¼ ë“±)
    section.post-view__footer
      -const boardPath = referrer.match(/^.*(?=\/\d)/)[0]; // regExp ex) '/community/board/14' => '/community/board'
      a(href= boardPath).post-view__footer__btn.post-view__footer__btn--board ëª©ë¡
      //- ë¡œê·¸ì¸ ë˜ì–´ìˆëŠ” ìœ ì €ì™€ í˜„ì¬ ê²Œì‹œê¸€ì˜ ì‘ì„±ìê°€ ì¼ì¹˜í•œë‹¤ë©´, ìˆ˜ì •í•˜ê¸°ì™€ ì‚­ì œí•˜ê¸° ë²„íŠ¼ on
      if accessUser === post.UserId
        -const updatePagePath = `${referrer}/update`
        -const deletePath = `${referrer}/delete?_method=DELETE`
        section.post-view__footer__writer-btns
          a(href= updatePagePath).post-view__footer__btn.post-view__footer__btn--update ìˆ˜ì •
          form(action= deletePath method="post").post-view__footer__delete-form
            submit(name="").post-view__footer__btn.post-view__footer__btn--delete ì‚­ì œ
    |
    |
    // ê²Œì‹œê¸€ ëŒ“ê¸€
    section.post-view__comment
      div.post-view__comment__cnt
        span ëŒ“ê¸€
        span= comments.length
      ul.post-view__comment__list
        //- ëŒ“ê¸€ ìƒì„± mixin
        mixin commentItem(userId, createdAt, updatedAt, comment)
          li.post-view__comment__item
            section.post-view__comment__info
              span= userId
              +processDateTime(createdAt, updatedAt, 'comment')
            section.post-view__comment__content-wrap
              pre.post-view__comment__content= comment
        |
        |
        each comment in comments
          - const currData = comment.dataValues;
          +commentItem(currData.UserId, currData.createdAt, currData.updatedAt, currData.comment)
      if user
        form(action=`` method="post").post-view__comment__form
          textarea(placeholder="ì†Œì¤‘í•œ ëŒ“ê¸€ í•˜ë‚˜í•˜ë‚˜ê°€ ê¸€ ì‘ì„±ìì—ê²Œ í° í˜ì´ ë©ë‹ˆë‹¤." minlength="1" maxlength="400" required).post-view__comment__textarea
          button(type="button").post-view__comment__btn ëŒ“ê¸€ ë“±ë¡
      else
        p(class="js-recommendLoginMsg" style="margin-top: 1rem; text-align: right; font-weight: 700") ë¡œê·¸ì¸í•˜ì—¬ ëŒ“ê¸€ì„ ì‘ì„±í•´ë³´ì„¸ìš”!

    //- (ìœ„ì—ì„œ ë°›ì€ boardPathë¡œ postList ì‚½ì… ì˜ˆì •)